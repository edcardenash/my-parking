<h1 class="mt-4 mb-4 text-center"><strong><%= @parking.name.capitalize %></strong></h1>
<hr>
<div class="row">
  <div class="col-7">
    <div class="row text-center">
      <div class="col-2">
        <p><i class="fa-regular fa-comment-dots"></i> <%= @parking.reviews.count %> reviews</p>
      </div>
      <div class="col-2">
        <p><i class="<%= @parking.reviews.average(:rating) == nil ? "fa-regular fa-star" : "fa-solid fa-star" %>"></i> <%= @parking.reviews.average(:rating) %></p>
      </div>
      <div class="col-3">
        <p><i class="fa-solid fa-location-dot"></i> <%= @parking.address %></p>
      </div>
    </div>
    <div class="row">
      <ul class="list-group list-group-flush">
        <li class="list-group-item">Descripción: <%= @parking.description %></li>
        <li class="list-group-item">Valor diario: <%= @parking.price_per_day %></li>
        <li class="list-group-item">¿Es cubierto?: <%= @parking.covered ? "Si" : "No" %></li>
        <li class="list-group-item">Vehiculos recomendados: <%= @parking.vehicle_type %></li>
        <li class="list-group-item">Ciudad: <%= @parking.city.name  %></li>
        <li class="list-group-item">Usuario: <%= @parking.user.first_name  %></li>
        <li class="list-group-item">Estado: <%= @parking.rented ? "Rentado" : "Disponible"  %></li>
      </ul>
    </div>
  </div>


  <div class="col-4">
    <% unless @owner %>
      <h3 class="mt-3 mb-3 text-center">¡Reserva este parking!</h3>
      <%= render 'shared/rental_form', rental: @rental %>
    <% end %>

    <%= cl_image_tag(@parking.photo.key, height: 300, width: 400, crop: :fill, :transformation=>[
      {:border=>"2px_solid_grey", :radius=>7}
    ])%>
  </div>
</div>


<% unless @parking.reviews.count.zero? %>
  <h2 class="mt-4">Reviews</h2>
  <% @parking.reviews.each do |review|%>
    <figure>
      <blockquote class="blockquote">
        <p><%= review.comment %></p>
      </blockquote>
      <figcaption class="blockquote-footer">
        <%= review.user.first_name%> <cite title="rating">
        <p><i class="<%= review.rating == nil ? "fa-regular fa-star" : "fa-solid fa-star" %>"></i>
        <%= review.rating %></p></cite>
      </figcaption>
    </figure>
    <hr>
  <% end %>
<% else %>
  <h3>Sin reviews por el momento</h3>
<%end%>



<% unless @owner %>
  <h2 class="mt-4">Agregar un review</h2>
  <%= simple_form_for [@parking, @review] do |f| %>
    <%= f.input :comment, as: :text %>
    <%= f.input :rating, class: "form-control" %>
    <%= f.submit "Agregar review", class: "btn btn-primary" %>
  <% end %>
  <% if @parking.rented? == true && @parking.rental.user_id == current_user.id %>
    <h2>Agregar un review</h2>
    <%= simple_form_for [@parking, @review] do |f| %>
      <%= f.input :comment %>
      <%= f.input :rating %>
      <%= f.submit "Agregar un review", class: "btn btn-primary" %>
    <% end %>
  <% end %>
<% else %>
  <h4>Para reservar este parking <strong><%= link_to "Inicia sesión", new_user_session_path, class: "nav-link" %></strong></h4>
<% end %>
